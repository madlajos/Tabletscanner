<div class="camera-settings-container">

  <!-- User Settings -->
  <section class="user-settings">
    <h3>User Settings</h3>
    <table class="user-settings-table">
      <thead>
        <tr>
          <th>Parameter</th>
          <th>Value</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Class 1 Limit (%)</td>
          <td>
            <input type="number"
                   [(ngModel)]="sizeLimits['class1']"
                   (blur)="applySizeLimit('class1')"
                   class="styled-input"
                   [disabled]="measurementActive" />
          </td>
        </tr>
        <tr>
          <td>Class 2 Limit (%)</td>
          <td>
            <input type="number"
                   [(ngModel)]="sizeLimits['class2']"
                   (blur)="applySizeLimit('class2')"
                   class="styled-input"
                   [disabled]="measurementActive" />
          </td>
        </tr>
        <tr>
          <td>Class 1 Count Limit</td>
          <td>
            <input type="number"
                   [(ngModel)]="sizeLimits['ng_limit']"
                   (blur)="applySizeLimit('ng_limit')"
                   class="styled-input"
                   [disabled]="measurementActive" />
          </td>
        </tr>
        <tr>
          <td>Save Data to CSV</td>
          <td>
            <input type="checkbox"
                   [(ngModel)]="saveSettings['save_csv']"
                   (change)="applySaveSetting('save_csv')"
                   class="styled-input"
                   [disabled]="measurementActive" />
          </td>
        </tr>
        <tr>
          <td colspan="2" class="csv-dir-cell">
            <div class="csv-input-wrapper">
              <!-- Small browse button first -->
              <button
                type="button"
                (click)="openFolderBrowser()"
                [disabled]="measurementActive"
                class="csv-dir-btn">
                <mat-icon>folder_open</mat-icon>
              </button>

              <!-- Path textbox second -->
              <input
                type="text"
                class="styled-input dir-display"
                [(ngModel)]="saveSettings['csv_dir']"
                [disabled]="measurementActive"
                readonly />
            </div>
          </td>
        </tr>
        <tr>
          <td>Save Analysed Images</td>
          <td>
            <input type="checkbox"
                   [(ngModel)]="saveSettings['save_images']"
                   (change)="applySaveSetting('save_images')"
                   class="styled-input"
                   [disabled]="measurementActive" />
          </td>
        </tr>
      </tbody>
    </table>
  </section>

  <!-- Divider -->
  <hr class="divider">

  <!-- Developer Settings -->
  <section class="developer-settings">
    <h3>Kamerabeállítások</h3>

    <table class="camera-settings-table">
      <thead>
        <tr>
          <th>Paraméter</th>
          <th>Érték</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Szélesség</td>
          <td>
            <input type="text"
                   [(ngModel)]="cameraSettings.Width"
                   (blur)="applySetting('Width')"
                   [disabled]="!isConnected">
          </td>
        </tr>
        <tr>
          <td>Magasság</td>
          <td>
            <input type="text"
                   [(ngModel)]="cameraSettings.Height"
                   (blur)="applySetting('Height')"
                   [disabled]="!isConnected">
          </td>
        </tr>
        <tr>
          <td>X Eltolás</td>
          <td>
            <input type="text"
                   [(ngModel)]="cameraSettings.OffsetX"
                   (blur)="applySetting('OffsetX')"
                   [disabled]="!isConnected">
          </td>
        </tr>
        <tr>
          <td>Y Eltolás</td>
          <td>
            <input type="text"
                   [(ngModel)]="cameraSettings.OffsetY"
                   (blur)="applySetting('OffsetY')"
                   [disabled]="!isConnected">
          </td>
        </tr>
        <tr>
          <td>Expozíciós idő</td>
          <td>
            <input type="text"
                   [(ngModel)]="cameraSettings.ExposureTime"
                   (blur)="applySetting('ExposureTime')"
                   [disabled]="!isConnected">
          </td>
        </tr>
        <tr>
          <td>Erősítés<source media="(min-width: )" srcset="" type="image/"></td>
          <td>
            <input type="text"
                   [(ngModel)]="cameraSettings.Gain"
                   (blur)="applySetting('Gain')"
                   [disabled]="!isConnected">
          </td>
        </tr>
        <tr>
          <td>Gamma</td>
          <td>
            <input type="text"
                   [(ngModel)]="cameraSettings.Gamma"
                   (blur)="applySetting('Gamma')"
                   [disabled]="!isConnected">
          </td>
        </tr>
        <tr>
          <td>FPS</td>
          <td>
            <input type="text"
                   [(ngModel)]="cameraSettings.FrameRate"
                   (blur)="applySetting('FrameRate')"
                   [disabled]="!isConnected">
          </td>
        </tr>

        <!-- Controls -->
        <tr>
          <td>Vezérlés</td>
          <td>
            <div class="button-group">
              <button type="button"
                      (click)="toggleConnection()"
                      [ngClass]="{'connect-button': true, 'connected': isConnected}">
                <mat-icon *ngIf="isConnected; else connectIcon">link_off</mat-icon>
                <ng-template #connectIcon><mat-icon>link</mat-icon></ng-template>
              </button>

              <button type="button"
                      (click)="toggleStream()"
                      [ngClass]="{'stream-button': true, 'streaming': isStreaming}"
                      [disabled]="!isConnected">
                <mat-icon *ngIf="isStreaming; else playIcon">stop</mat-icon>
                <ng-template #playIcon><mat-icon>play_arrow</mat-icon></ng-template>
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </section>
</div>