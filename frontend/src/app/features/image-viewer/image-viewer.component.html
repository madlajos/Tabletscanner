<div class="image-viewer-container">
  <div class="top-bar">
    <div class="camera-name">
      Camera
      <span class="status-indicator" [ngClass]="{
          'disconnected': !sharedService.getCameraConnectionStatus(),
          'connected': sharedService.getCameraConnectionStatus() && !sharedService.getCameraStreamStatus(),
          'streaming': sharedService.getCameraStreamStatus()
        }">
      </span>
    </div>
  </div>

  <div class="live-view">
    <div #videoContainer class="video-host" [class.hidden]="!sharedService.getCameraStreamStatus()" 
         [class.zoomed]="isZoomed()" 
         [style.cursor]="getCursorStyle()"></div>

    <button class="capture-button" (click)="captureImage()" [disabled]="!sharedService.getCameraStreamStatus() || isCaptureCooldown"
      title="Save Snapshot">
      <mat-icon>photo_camera</mat-icon>
    </button>
  </div>



</div>

@if (savedImages.length > 0) {
  <div class="gallery-container">
    <div class="gallery-scroll">
      @for (img of savedImages; track img.path) {
        <div class="thumb"
             (click)="openImage(img)"
             (contextmenu)="onImageContextMenu($event, img)"
             title="{{ img.path }}">
          <img
            [src]="img.url"
            alt="saved image thumbnail"
            loading="lazy"
            decoding="async"
          />
        </div>
      }
    </div>
  </div>
}

<!-- Custom context menu -->
@if (contextMenuVisible) {
  <div class="context-menu" 
       [style.left.px]="contextMenuX"
       [style.top.px]="contextMenuY"
       (mouseleave)="hideContextMenu()">
    <div class="context-menu-item" (click)="contextMenuOpen()">
      <mat-icon>open_in_new</mat-icon>
      <span>Megnyitás</span>
    </div>
    <div class="context-menu-item" (click)="contextMenuOpenFolder()">
      <mat-icon>folder_open</mat-icon>
      <span>Mappa megnyitása</span>
    </div>
  </div>
}